{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"C:/Users/\\u90ED\\u6653\\u98DE/Desktop/Edu/Education_nformation_platform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/Users/\\u90ED\\u6653\\u98DE/Desktop/Edu/Education_nformation_platform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/\\u90ED\\u6653\\u98DE/Desktop/Edu/Education_nformation_platform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:/Users/\\u90ED\\u6653\\u98DE/Desktop/Edu/Education_nformation_platform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:/Users/\\u90ED\\u6653\\u98DE/Desktop/Edu/Education_nformation_platform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/\\u90ED\\u6653\\u98DE/Desktop/Edu/Education_nformation_platform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{PureComponent}from'react';import PubSub from'pubsub-js';import{addClass,deleClass}from'../../../../func/toggleClass';import BackClassBtn from'../../../../components/content/BackClassBtn';import SingleBox from'../../../../containers/SingleBox';import DropDowm from'../../../../containers/DropDowm';import'./css/index.css';var CreateClass=/*#__PURE__*/function(_PureComponent){_inherits(CreateClass,_PureComponent);var _super=_createSuper(CreateClass);function CreateClass(){var _this;_classCallCheck(this,CreateClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={newClass:{students:0,headmaster:'田小雨'},schoolIstrue:false,//学校inpt框输入内容是否合法\nclassIstrue:false,//课程inpt框输入内容是否合法\ndisplay:'',width:'',height:'',hasError:''};_this.schoolRef=/*#__PURE__*/React.createRef();_this.schoolChildRef=/*#__PURE__*/React.createRef();_this.classRef=/*#__PURE__*/React.createRef();_this.classChildRef=/*#__PURE__*/React.createRef();_this.schoolInptChange=function(){var _assertThisInitialize=_assertThisInitialized(_this),schoolRef=_assertThisInitialize.schoolRef,value=_assertThisInitialize.schoolRef.current.value,schoolChildRef=_assertThisInitialize.schoolChildRef,setSchoolValue=_assertThisInitialize.props.setSchoolValue;var reg=new RegExp(\"^[\\u4E00-\\u9FA5 ]{4,20}$|^[A-z ]{5,50}$\",'g');var str=value;// 去除中间多余的空格\nstr=str.replace(/\\s{2,}/g,\" \");// 去除首尾的空格\nstr=str.replace(/^\\s*|\\s*$/g,\"\");// 纠正非法输入\nschoolRef.current.value=str;var reslt=reg.test(str);if(!Boolean(reslt)){// 显示输入错误提示\ndeleClass(schoolChildRef.current,'school-true-tips');deleClass(schoolChildRef.current,'school-tips-hide');setSchoolValue({school:value});//表单验证 错误名称\n// 更改旗帜\n_this.setState({schoolIstrue:false});}else{// 显示正确图标\naddClass(schoolChildRef.current,'school-true-tips');// 将数据保存在store\nsetSchoolValue({school:value});// 更改旗帜\n_this.setState({schoolIstrue:true});}};_this.classInptChange=function(){var _assertThisInitialize2=_assertThisInitialized(_this),classRef=_assertThisInitialize2.classRef,value=_assertThisInitialize2.classRef.current.value,classChildRef=_assertThisInitialize2.classChildRef,setClassValue=_assertThisInitialize2.props.setClassValue;var reg=/^[\\u4e00-\\u9fa5A-z0-9 ]{5,20}$/g;var str=value;// 去除中间多余的空格\nstr=str.replace(/\\s{2,}/g,\" \");// 去除首尾的空格\nstr=str.replace(/^\\s*|\\s*$/g,\"\");//去除_和%\nstr=str.replace(/[_%]/g,'');// 纠正非法输入\nclassRef.current.value=str;var reslt=reg.test(str);if(!reslt){// 显示输入错误提示\ndeleClass(classChildRef.current,'course-tips-true');deleClass(classChildRef.current,'course-tips-hide');setClassValue({course:value});//表单验证 错误名称\n_this.setState({classIstrue:false});}else{// 显示正确图标\naddClass(classChildRef.current,'course-tips-true');setClassValue({course:value});_this.setState({classIstrue:true});}};_this.saveData=function(e){// 取消按钮默认点击事件\ne.preventDefault();var _assertThisInitialize3=_assertThisInitialized(_this),_assertThisInitialize4=_assertThisInitialize3.props,createClass=_assertThisInitialize4.createClass,dropDowm=_assertThisInitialize4.dropDowm,_assertThisInitialize5=_assertThisInitialize4.dropDowm,section=_assertThisInitialize5.section,grade=_assertThisInitialize5.grade,singleBox=_assertThisInitialize4.singleBox,_assertThisInitialize6=_assertThisInitialize4.singleBox,classType=_assertThisInitialize6.classType,exitPermissions=_assertThisInitialize6.exitPermissions,setDropDowmValue=_assertThisInitialize4.setDropDowmValue,singleBoxFocusValue=_assertThisInitialize4.singleBoxFocusValue,_assertThisInitialize7=_assertThisInitialize3.state,newClass=_assertThisInitialize7.newClass,schoolIstrue=_assertThisInitialize7.schoolIstrue,classIstrue=_assertThisInitialize7.classIstrue,schoolRef=_assertThisInitialize3.schoolRef,classRef=_assertThisInitialize3.classRef,schoolChildRef=_assertThisInitialize3.schoolChildRef,classChildRef=_assertThisInitialize3.classChildRef;var resl=_objectSpread(_objectSpread(_objectSpread(_objectSpread({},newClass),createClass),singleBox),dropDowm);_this.setState({newClass:resl},function(){console.log(classType);console.log(grade);// 表单验证\nif(!schoolIstrue){alert(\"\\u5B66\\u6821\\u540D\\u79F0\\u4E0D\\u6B63\\u786E,\\u8BF7\\u91CD\\u65B0\\u8F93\\u5165\");}else if(section===undefined||section===''){alert('请选择学段');}else if(grade===undefined||grade===''){alert('请选择年级');}else if(!classIstrue){alert(\"\\u73ED\\u7EA7\\u540D\\u79F0\\u4E0D\\u6B63\\u786E,\\u8BF7\\u91CD\\u65B0\\u8F93\\u5165\");}else if(classType===undefined||classType===''){alert('请选择班级类型');}else if(exitPermissions===undefined||exitPermissions===''){alert('退出权限未设置');}else{// 发布数据给 class 页面 \nPubSub.publish('createClass',_this.state.newClass);// 初始化输入框\nschoolRef.current.value='';classRef.current.value='';// 初始化下拉框\nsetDropDowmValue({section:'',grade:''});// 初始化啊单选框\nsingleBoxFocusValue({classType:'',exitPermissions:''});// 通知DropDowm和singBox初始化状态\nPubSub.publish('initVuale');// 初始化tips\naddClass(classChildRef.current,'course-tips-hide');addClass(schoolChildRef.current,'school-tips-hide');// 显示成功添加弹框\n_this.setState({display:\"block\"});_this.setState({schoolIstrue:false});_this.setState({classIstrue:false});// 动态设置弹窗位置\n_this.timer=setInterval(function(){_this.setState({width:e.view.innerWidth});_this.setState({height:e.view.innerHeight});},100);}});};_this.backlCass=function(e){e.preventDefault();var push=_this.props.history.push;push('/class');// 停止计时器\nclearInterval(_this.timer);};_this.continueClick=function(e){// 取消默认行为\ne.preventDefault();// 影藏弹窗\n_this.setState({display:'none'});// 停止计时器\nclearInterval(_this.timer);};return _this;}_createClass(CreateClass,[{key:\"componentDidCatch\",value:function componentDidCatch(){console.log('此处统计错误，反馈给服务器，用于通知编码人员进行bug的解决');}// school onChange的回调\n},{key:\"render\",value:function render(){var classType=['行政班','教学班'];var exitPermissions=['允许退出','通知班级管理员审核后退出','禁止退出'];var grade=['年级','一年级','二年级','三年级','四年级'];var section=['学段','小学','初中','高中','大学'];var saveData=this.saveData,classInptChange=this.classInptChange,schoolInptChange=this.schoolInptChange,backlCass=this.backlCass,continueClick=this.continueClick,_this$state=this.state,display=_this$state.display,width=_this$state.width,height=_this$state.height;return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"class-create-totabar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"contenter-top-nav-bar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"route-title\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"\\u6211\\u7684\\u73ED\\u7EA7\"})}),/*#__PURE__*/_jsx(BackClassBtn,{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"class-create-bar\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"create-tip\",children:[\"\\u5C0A\\u656C\\u7684\",/*#__PURE__*/_jsx(\"span\",{children:\"\\u8001\\u5E08(\\u5218\\u8001\\u5E08)\"}),\"\\uFF0C\\u8BF7\\u586B\\u5199\\u73ED\\u7EA7\\u4FE1\\u606F\\uFF1A\"]}),/*#__PURE__*/_jsxs(\"form\",{action:\"\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"school\",children:[/*#__PURE__*/_jsx(\"i\",{children:\"\\u5B66\\u6821\"}),/*#__PURE__*/_jsx(\"input\",{ref:this.schoolRef,onChange:schoolInptChange,type:\"text\",placeholder:\"\\u8BF7\\u9009\\u62E9\\u5B66\\u6821\"}),/*#__PURE__*/_jsxs(\"div\",{ref:this.schoolChildRef,className:\"school-tips  school-tips-hide \",children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u8BF7\\u8F93\\u51654-20\\u4F4D\\u7684\\u4E2D\\u6587\\u6216\\u80055-50\\u4F4D\\u7684\\u5B57\\u6BCD\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"section\",children:[/*#__PURE__*/_jsxs(\"i\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"*\"}),\"\\u5B66\\u6BB5\"]}),this.state.hasError?/*#__PURE__*/_jsx(\"h2\",{children:\"\\u5F53\\u524D\\u7F51\\u7EDC\\u4E0D\\u7A33\\u5B9A\\uFF0C\\u7A0D\\u540E\\u518D\\u8BD5\"}):/*#__PURE__*/_jsx(DropDowm,{data:section,pubName:\"sectionValue\",liValue:\"section\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grade\",children:[/*#__PURE__*/_jsxs(\"i\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"*\"}),\"\\u5E74\\u7EA7\"]}),this.state.hasError?/*#__PURE__*/_jsx(\"h2\",{children:\"\\u5F53\\u524D\\u7F51\\u7EDC\\u4E0D\\u7A33\\u5B9A\\uFF0C\\u7A0D\\u540E\\u518D\\u8BD5\"}):/*#__PURE__*/_jsx(DropDowm,{data:grade,pubName:\"gradeValue\",liValue:\"grade\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"class-name\",children:[/*#__PURE__*/_jsxs(\"i\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"*\"}),\"\\u73ED\\u7EA7\\u540D\"]}),/*#__PURE__*/_jsx(\"input\",{onChange:classInptChange,ref:this.classRef,type:\"text\",name:\"\",id:\"\",placeholder:\"\\u8BF7\\u8F93\\u5165\\u73ED\\u7EA7\\u540D\\u79F0\\uFF0C\\u965020\\u5B57\\u7B26\\uFF0C\\u4E0D\\u652F\\u6301\\u8F93\\u5165_\\u548C%\"}),/*#__PURE__*/_jsxs(\"div\",{ref:this.classChildRef,className:\"course-tips  course-tips-hide\",children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u965020\\u5B57\\u7B26\\uFF0C\\u4E0D\\u652F\\u6301\\u8F93\\u5165_\\u548C%' \"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"class-type\",children:[/*#__PURE__*/_jsx(\"i\",{children:\"\\u7C7B\\u578B\"}),this.state.hasError?/*#__PURE__*/_jsx(\"h2\",{children:\"\\u5F53\\u524D\\u7F51\\u7EDC\\u4E0D\\u7A33\\u5B9A\\uFF0C\\u7A0D\\u540E\\u518D\\u8BD5\"}):/*#__PURE__*/_jsx(SingleBox,{data:classType,singleBoxName:\"classType\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"exit-permissions\",children:[/*#__PURE__*/_jsx(\"i\",{children:\"\\u9000\\u51FA\\u6743\\u9650\\u8BBE\\u7F6E\"}),this.state.hasError?/*#__PURE__*/_jsx(\"h2\",{children:\"\\u5F53\\u524D\\u7F51\\u7EDC\\u4E0D\\u7A33\\u5B9A\\uFF0C\\u7A0D\\u540E\\u518D\\u8BD5\"}):/*#__PURE__*/_jsx(SingleBox,{data:exitPermissions,singleBoxName:\"exitPermissions\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:saveData,children:\"\\u4FDD\\u5B58\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"confirm-Window\",style:{display:display,width:width,height:height},children:/*#__PURE__*/_jsxs(\"div\",{className:\"confirm-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"confirm-content\",children:\"\\u6DFB\\u52A0\\u73ED\\u7EA7\\u6210\\u529F\\uFF01\\uFF01\\uFF01\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"btns\",children:[/*#__PURE__*/_jsx(\"a\",{onClick:backlCass,href:\"/\",className:\"btn-back\",children:\"\\u8FD4\\u56DE\\u6211\\u7684\\u73ED\\u7EA7\"}),/*#__PURE__*/_jsx(\"a\",{onClick:continueClick,href:\"/\",className:\"btn-continue\",children:\"\\u7EE7\\u7EED\\u6DFB\\u52A0\"})]})]})})]})]})});}}],[{key:\"getDerivedStateFromError\",//当子组件出现报错时候，会触发getDerivedStateFromError调用，并携带错误信息\nvalue:function getDerivedStateFromError(error){return{hasError:error};}}]);return CreateClass;}(PureComponent);export{CreateClass as default};","map":{"version":3,"sources":["C:/Users/郭晓飞/Desktop/Edu/Education_nformation_platform/src/page/Set/Class/Create/index.jsx"],"names":["React","PureComponent","PubSub","addClass","deleClass","BackClassBtn","SingleBox","DropDowm","CreateClass","state","newClass","students","headmaster","schoolIstrue","classIstrue","display","width","height","hasError","schoolRef","createRef","schoolChildRef","classRef","classChildRef","schoolInptChange","value","current","setSchoolValue","props","reg","RegExp","str","replace","reslt","test","Boolean","school","setState","classInptChange","setClassValue","course","saveData","e","preventDefault","createClass","dropDowm","section","grade","singleBox","classType","exitPermissions","setDropDowmValue","singleBoxFocusValue","resl","console","log","alert","undefined","publish","timer","setInterval","view","innerWidth","innerHeight","backlCass","push","history","clearInterval","continueClick","error"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react'\r\nimport PubSub from 'pubsub-js'\r\n\r\nimport {\r\n  addClass,\r\n  deleClass,\r\n} from '../../../../func/toggleClass'\r\nimport BackClassBtn from '../../../../components/content/BackClassBtn'\r\nimport SingleBox from '../../../../containers/SingleBox'\r\nimport DropDowm from '../../../../containers/DropDowm'\r\nimport './css/index.css'\r\n\r\nexport default class CreateClass extends PureComponent {\r\n\r\n  state = {\r\n    newClass: { students: 0, headmaster: '田小雨', },\r\n    schoolIstrue: false,//学校inpt框输入内容是否合法\r\n    classIstrue: false,//课程inpt框输入内容是否合法\r\n    display: '',\r\n    width: '',\r\n    height: '',\r\n    hasError: ''\r\n  }\r\n\r\n  // ref 容器\r\n  schoolRef = React.createRef()\r\n  schoolChildRef = React.createRef()\r\n  classRef = React.createRef()\r\n  classChildRef = React.createRef()\r\n\r\n\r\n  //当子组件出现报错时候，会触发getDerivedStateFromError调用，并携带错误信息\r\n  static getDerivedStateFromError(error) {\r\n    return { hasError: error }\r\n  }\r\n\r\n  componentDidCatch() {\r\n    console.log('此处统计错误，反馈给服务器，用于通知编码人员进行bug的解决');\r\n  }\r\n\r\n\r\n  // school onChange的回调\r\n  schoolInptChange = () => {\r\n    const {\r\n      schoolRef,\r\n      schoolRef: { current: { value } },\r\n      schoolChildRef,\r\n      props: { setSchoolValue }\r\n\r\n    } = this\r\n    const reg = new RegExp('^[\\u4e00-\\u9fa5 ]{4,20}$|^[A-z ]{5,50}$', 'g')\r\n    let str = value\r\n    // 去除中间多余的空格\r\n    str = str.replace(/\\s{2,}/g, \" \")\r\n    // 去除首尾的空格\r\n    str = str.replace(/^\\s*|\\s*$/g, \"\")\r\n    // 纠正非法输入\r\n    schoolRef.current.value = str\r\n\r\n    const reslt = reg.test(str)\r\n    if (!Boolean(reslt)) {\r\n      // 显示输入错误提示\r\n      deleClass(schoolChildRef.current, 'school-true-tips')\r\n      deleClass(schoolChildRef.current, 'school-tips-hide')\r\n      setSchoolValue({ school: value })//表单验证 错误名称\r\n      // 更改旗帜\r\n      this.setState({ schoolIstrue: false })\r\n    } else {\r\n      // 显示正确图标\r\n      addClass(schoolChildRef.current, 'school-true-tips')\r\n\r\n      // 将数据保存在store\r\n      setSchoolValue({ school: value })\r\n      // 更改旗帜\r\n      this.setState({ schoolIstrue: true })\r\n\r\n    }\r\n  }\r\n  //class-name onChange的回调\r\n  classInptChange = () => {\r\n    const {\r\n      classRef, classRef: { current: { value } },\r\n      classChildRef,\r\n      props: { setClassValue }\r\n    } = this\r\n    const reg = /^[\\u4e00-\\u9fa5A-z0-9 ]{5,20}$/g\r\n    let str = value\r\n\r\n    // 去除中间多余的空格\r\n    str = str.replace(/\\s{2,}/g, \" \")\r\n    // 去除首尾的空格\r\n    str = str.replace(/^\\s*|\\s*$/g, \"\")\r\n    //去除_和%\r\n    str = str.replace(/[_%]/g, '')\r\n    // 纠正非法输入\r\n    classRef.current.value = str\r\n    const reslt = reg.test(str)\r\n    if (!reslt) {\r\n      // 显示输入错误提示\r\n      deleClass(classChildRef.current, 'course-tips-true')\r\n      deleClass(classChildRef.current, 'course-tips-hide')\r\n      setClassValue({ course: value })//表单验证 错误名称\r\n      this.setState({ classIstrue: false })\r\n    } else {  \r\n      // 显示正确图标\r\n      addClass(classChildRef.current, 'course-tips-true')\r\n      setClassValue({ course: value })\r\n      this.setState({ classIstrue: true })\r\n    }\r\n  }\r\n\r\n  // 点击保存按钮的回调\r\n  saveData = (e) => {\r\n    // 取消按钮默认点击事件\r\n    e.preventDefault()\r\n    const {\r\n      props: {\r\n        createClass,\r\n        dropDowm,\r\n        dropDowm: { section, grade },\r\n        singleBox, singleBox: { classType, exitPermissions },\r\n        setDropDowmValue,\r\n        singleBoxFocusValue\r\n      },\r\n      state: { newClass, schoolIstrue, classIstrue },\r\n      schoolRef,\r\n      classRef,\r\n      schoolChildRef,\r\n      classChildRef,\r\n\r\n    } = this\r\n\r\n    const resl = { ...newClass, ...createClass, ...singleBox, ...dropDowm }\r\n    this.setState({ newClass: resl }, () => {\r\n\r\n      console.log(classType);\r\n      console.log(grade);\r\n      // 表单验证\r\n      if (!schoolIstrue) {\r\n        alert(`学校名称不正确,请重新输入`)\r\n      } else if (section === undefined||section === '') {\r\n        alert('请选择学段')\r\n      } else if (grade === undefined || grade === '') {\r\n        alert('请选择年级')\r\n      } else if (!classIstrue) {\r\n        alert(`班级名称不正确,请重新输入`)\r\n      } else if (classType === undefined||classType === '') {\r\n        alert('请选择班级类型')\r\n      } else if (exitPermissions === undefined||exitPermissions === '') {\r\n        alert('退出权限未设置')\r\n      } else {\r\n\r\n        // 发布数据给 class 页面 \r\n        PubSub.publish('createClass', this.state.newClass)\r\n\r\n        // 初始化输入框\r\n        schoolRef.current.value = ''\r\n        classRef.current.value = ''\r\n        // 初始化下拉框\r\n        setDropDowmValue({\r\n          section: '',\r\n          grade: ''\r\n        })\r\n        // 初始化啊单选框\r\n        singleBoxFocusValue({\r\n          classType: '',\r\n          exitPermissions: ''\r\n        })\r\n        \r\n        // 通知DropDowm和singBox初始化状态\r\n        PubSub.publish('initVuale')\r\n\r\n        // 初始化tips\r\n        addClass(classChildRef.current, 'course-tips-hide')\r\n        addClass(schoolChildRef.current, 'school-tips-hide')\r\n\r\n\r\n        // 显示成功添加弹框\r\n        this.setState({ display: \"block\" })\r\n        this.setState({ schoolIstrue: false })\r\n        this.setState({ classIstrue: false })\r\n        // 动态设置弹窗位置\r\n        this.timer = setInterval(() => {\r\n          this.setState({ width: e.view.innerWidth })\r\n          this.setState({ height: e.view.innerHeight })\r\n        }, 100);\r\n\r\n      }\r\n\r\n\r\n    })\r\n\r\n  }\r\n\r\n  // 弹窗返回我的班级回调\r\n  backlCass = (e) => {\r\n    e.preventDefault()\r\n    const { push } = this.props.history\r\n    push('/class')\r\n\r\n    // 停止计时器\r\n    clearInterval(this.timer)\r\n  }\r\n\r\n  // 弹窗继续添加回调\r\n  continueClick = (e) => {\r\n    // 取消默认行为\r\n    e.preventDefault()\r\n    // 影藏弹窗\r\n    this.setState({ display: 'none' })\r\n\r\n\r\n    // 停止计时器\r\n    clearInterval(this.timer)\r\n\r\n  }\r\n\r\n  render() {\r\n\r\n    const classType = ['行政班', '教学班']\r\n    const exitPermissions = ['允许退出', '通知班级管理员审核后退出', '禁止退出']\r\n    const grade = ['年级', '一年级', '二年级', '三年级', '四年级']\r\n    const section = ['学段', '小学', '初中', '高中', '大学']\r\n    const { saveData, classInptChange, schoolInptChange, backlCass, continueClick, state: { display, width, height } } = this\r\n    return (\r\n      <div>\r\n        <div className='class-create-totabar'>\r\n          {/* 顶部导航 */}\r\n          <div className=\"contenter-top-nav-bar\">\r\n            <div className=\"route-title\">\r\n              <h2 >我的班级</h2>\r\n            </div>\r\n            {/* <button className='creat-class'>创建班级</button> */}\r\n            <BackClassBtn />\r\n          </div>\r\n\r\n          <div className=\"class-create-bar\">\r\n            <p className='create-tip'>尊敬的<span>老师(刘老师)</span>，请填写班级信息：</p>\r\n            <form action=\"\">\r\n\r\n              {/* 输入学校 */}\r\n              <div className='school'>\r\n                <i>学校</i><input ref={this.schoolRef} onChange={schoolInptChange} type=\"text\" placeholder='请选择学校' />\r\n                <div ref={this.schoolChildRef} className='school-tips  school-tips-hide '><div></div><p>请输入4-20位的中文或者5-50位的字母</p></div>\r\n              </div>\r\n\r\n              {/* 选择选段 */}\r\n              <div className=\"section\">\r\n                <i><span>*</span>学段</i>\r\n                {\r\n                  this.state.hasError ? <h2>当前网络不稳定，稍后再试</h2> : <DropDowm data={section} pubName='sectionValue' liValue='section' />\r\n                }\r\n\r\n              </div>\r\n\r\n              {/* 选择年级 */}\r\n              <div className=\"grade\">\r\n                <i><span>*</span>年级</i>\r\n                {\r\n                  this.state.hasError ? <h2>当前网络不稳定，稍后再试</h2> : <DropDowm data={grade} pubName='gradeValue' liValue='grade' />\r\n                }\r\n\r\n              </div>\r\n\r\n              {/* 输入班级名 */}\r\n              <div className='class-name'>\r\n                <i><span>*</span>班级名</i><input onChange={classInptChange} ref={this.classRef} type=\"text\" name=\"\" id=\"\" placeholder='请输入班级名称，限20字符，不支持输入_和%' />\r\n                <div ref={this.classChildRef} className='course-tips  course-tips-hide'><div></div><p>限20字符，不支持输入_和%' </p></div>\r\n              </div>\r\n\r\n              {/* 选择类型 */}\r\n              <div className='class-type'>\r\n                <i>类型</i>\r\n                {\r\n                  this.state.hasError ? <h2>当前网络不稳定，稍后再试</h2> : <SingleBox data={classType} singleBoxName='classType' />\r\n                }\r\n\r\n              </div>\r\n\r\n              {/* 退出权限设置 */}\r\n              <div className='exit-permissions'>\r\n                <i>退出权限设置</i>\r\n                {\r\n                  this.state.hasError ? <h2>当前网络不稳定，稍后再试</h2> : <SingleBox data={exitPermissions} singleBoxName='exitPermissions' />\r\n                }\r\n\r\n\r\n              </div>\r\n              {/* 保存按钮 */}\r\n              <button onClick={saveData}>保存</button>\r\n\r\n\r\n            </form>\r\n            <div className=\"confirm-Window\" style={{ display, width, height }}>\r\n              <div className=\"confirm-body\" >\r\n                <div className=\"confirm-content\">添加班级成功！！！</div>\r\n                <div className=\"btns\">\r\n                  <a onClick={backlCass} href=\"/\" className=\"btn-back\" >返回我的班级</a>\r\n                  <a onClick={continueClick} href=\"/\" className=\"btn-continue\"  >继续添加</a>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}