{"version":3,"sources":["network/request.js","components/content/ClassSynopsis/index.jsx","page/Set/Class/index.jsx"],"names":["request","config","instance","axios","create","baseURL","timeout","interceptors","use","err","console","log","response","res","data","ClassSynopsis","state","students","teachers","parents","id","this","props","method","url","then","setState","section","grade","headmaster","classType","onClick","showClassMenber","className","style","fontWeight","length","PureComponent","Detail","lazy","Create","MyClass","classes","getClassse","catch","createClassToken","PubSub","subscribe","a","unsubscribe","to","map","classesObj","fallback","Loading","path","component"],"mappings":"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","file":"static/js/7.657fd7ba.chunk.js","sourcesContent":["import axios from 'axios'\r\n\r\n\r\n// {//config 的参数\r\n//   //请求类型\r\n//   method: 'POST',\r\n//     //URL\r\n//   url: 'http://localhost:3001',\r\n//       //设置请求体\r\n//   data: {\r\n//     title: \"今天天气不错, 还挺风和日丽的\",\r\n//       author: \"张三\"\r\n//   }\r\nexport function request(config) {\r\n\r\n  // 1.创建axios的实例对象\r\n  const instance = axios.create({\r\n    baseURL: 'http://localhost:3001',\r\n    timeout: 5000\r\n  })\r\n\r\n  // 2.axios 的拦截器\r\n  // 2.1.请求拦截的作用\r\n  instance.interceptors.request.use(\r\n    config => {\r\n      // 拦截之后必须将结果返回\r\n      return config\r\n    },\r\n    err => {\r\n      console.log(err);\r\n    })\r\n\r\n  // 2.2.响应拦截\r\n  instance.interceptors.response.use(\r\n    res => {\r\n      // console.log(res);\r\n      // 只需要将data放回即可 \r\n      return res.data\r\n    },\r\n    err => {\r\n      console.log(err);\r\n    })\r\n\r\n  // 3.发送真正的网络请求\r\n  return instance(config)//本身(源码)就是一个 promise 所以可以用then catch\r\n\r\n\r\n}","import React, { PureComponent } from 'react'\r\nimport { request } from '../../../network/request'\r\nimport './css/index.css'\r\nexport default class ClassSynopsis extends PureComponent {\r\n\r\n  state = {\r\n    students: [],\r\n    teachers: [],\r\n    parents: []\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n    const id = this.props.id\r\n    request({\r\n      method: 'GET',\r\n      url: `/classes/${id}/students`,\r\n    }).then(res => {\r\n      // console.log(res);\r\n      this.setState({ students: res })\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { students } = this.state\r\n    const { section, grade, headmaster, classType } = this.props\r\n    return (\r\n      <div onClick={this.showClassMenber} className=\"class-details\">\r\n        <div className='course-logo'></div>\r\n        <div className=\"class-detail\">\r\n          <p>{section}</p>\r\n          <p><i>年级：</i><span>{grade}</span></p>\r\n          <p><i>班主任：</i><span style={{ fontWeight: 'bold' }}>{headmaster}</span></p>\r\n          <p><i>学生：</i><span>{students.length || 0}人</span></p>\r\n        </div>\r\n        <button className='class-details-btn'>{classType}</button>\r\n        <div className='class-detail-setting'></div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import React, { PureComponent, lazy, Suspense} from 'react'\r\nimport { Link, Route, Switch } from 'react-router-dom'\r\nimport PubSub from 'pubsub-js'\r\n\r\nimport { request } from '../../../network/request'\r\n\r\nimport Loading from '../../Loading'\r\nimport ClassSynopsis from '../../../components/content/ClassSynopsis'\r\n\r\n\r\nimport './css/index.css'\r\n// 路由懒加载\r\nconst Detail = lazy(() => import('../../../containers/Detail'))\r\nconst Create = lazy(() => import('../../../containers/Create'))\r\n\r\nexport default class MyClass extends PureComponent {\r\n\r\n\r\n  state = {\r\n    classes: []\r\n  }\r\n  // 组件加载完成\r\n  componentDidMount() {\r\n\r\n    // 订阅创建班级表单提交\r\n    this.createClassToken = PubSub.subscribe('createClass', (a, data) => {\r\n\r\n      const { section, grade, headmaster, classType } = data\r\n      // 向数据库添加一条数据\r\n      request({\r\n        method: 'POST',\r\n        url: '/classes',\r\n        data: {\r\n          section, grade, headmaster, classType\r\n        }\r\n      }).then(res => {\r\n        // console.log(res);\r\n        // 获取新的数据 刷新页面\r\n        this.getClassse()\r\n      }).catch(err => console.log(err))\r\n\r\n    })\r\n    // 获取classes数据\r\n    this.getClassse()\r\n  }\r\n\r\n  // 组件将要卸载\r\n  componentWillUnmount() {\r\n    // 取消订阅\r\n    PubSub.unsubscribe(this.createClassToken)\r\n  }\r\n\r\n  // 二次封装axios\r\n  getClassse = () => {\r\n    request({\r\n      method: 'GET',\r\n      url: '/classes'\r\n    }).then(res => {\r\n      // console.log(res);\r\n      this.setState({ classes: res })\r\n    }).catch(err => { console.log(err); })\r\n  }\r\n\r\n  render() {\r\n    const { classes } = this.state\r\n    return (\r\n      <div>\r\n        {/* 顶部导航 */}\r\n        <div className=\"contenter-top-nav-bar\">\r\n          <div className=\"route-title\">\r\n            <h2 >我的班级</h2>\r\n          </div>\r\n          <Link to='/class/create' ><button className='creat-class'>创建班级</button></Link>\r\n          {/* <button className='join-class'>加入班级</button> */}\r\n        </div>\r\n        <div className=\"class-totall-bar\">\r\n          <h3>行政班是为学生管理和教学管理而建设的班级</h3>\r\n\r\n          <div className=\"class-bar\">\r\n            {\r\n              classes.map(classesObj =>\r\n                classesObj.classType === '行政班' ?\r\n                  <Link to={`/class/${classesObj.id}`} key={classesObj.id}  >\r\n                    < ClassSynopsis  {...classesObj} />\r\n                  </Link> : []\r\n              )\r\n            }\r\n          </div>\r\n\r\n          <h3>教学班是根据教学要求而设置的班级</h3>\r\n          <div className=\"class-bar\">\r\n            {\r\n              classes.map(classesObj => classesObj.classType === '教学班' ?\r\n                <Link to={`/class/${classesObj.id}`} key={classesObj.id}  >\r\n                  < ClassSynopsis  {...classesObj} />\r\n                </Link> : []\r\n              )\r\n            }\r\n          </div>\r\n        </div>\r\n        <Suspense fallback={<Loading></Loading>}>\r\n          <Switch>\r\n            <Route path='/class/create' component={Create}></Route>\r\n            <Route path={`/class/:id`} component={Detail}></Route>\r\n          </Switch>\r\n          </Suspense>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"],"sourceRoot":""}